;
; LAB4_1_1.asm
; 1KhZ -> N = 8 -> 1 CK = 8000 MC 
.EQU	P_OUT	=0
.EQU	TF		=-3995 ;TF=giá tr? ??t tr??c

.ORG	0
RJMP	MAIN

.ORG	0X1E
RJMP	OVERFLOW

.ORG	0X40
MAIN: 
LDI		R16,	HIGH(RAMEND)
OUT		SPH,	R16
LDI		R16,	LOW(RAMEND)
OUT		SPL,	R16

SEI	

LDI		R16,	(1<<P_OUT) ;??t P_OUT output
OUT		DDRC,	R16

LDI		R16,	HIGH(TF)
STS		TCNT1H,	R16
LDI		R16,	LOW(TF)
STS		TCNT1L,	R16

LDI		R16,	1
STS		TIMSK1,	R16

LDI		R17,	0X00 ;Timer1 mode NOR
STS		TCCR1A,	R17

LDI		R17,	0X01 ;Timer1 mode NOR, n = 1
STS		TCCR1B,	R17

SBI		PORTC,	0
START: 
RJMP	START


OVERFLOW:

LDI		R16,	HIGH(TF)
STS		TCNT1H,	R16
LDI		R16,	LOW(TF)
STS		TCNT1L,	R16

IN		R16,	PORTC
COM		R16
ANDI	R16,	1
OUT		PORTC,	R16

RETI

